<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>外出登記表</title>
    <style>
        /* 讓表格高度填滿視窗 */
        html, body {
            height: 100%;
            margin: 0;
        }
        table {
            width: 100%;
            height: 100%; /* 讓表格撐滿視窗 */
            border-collapse: collapse;
            table-layout: fixed; /* 固定列寬 */
        }
        th, td {
            border: 1px solid #9a9a9a; /* 改為灰色的邊框 */
            text-align: center;
            font-size: 50pt; /* 調整文字大小 */
        }
        th {
            background-color: #0056b3;
            color: white;
        }
        tbody tr {
            height: 12.5%; /* 保證每行等高分配 */
        }
    </style>
</head>
<body>
    <table id="editableTable">
        <thead>
            <tr>
                <th>姓名</th>
                <th>外出時間</th>
                <th>回來時間</th>
                <th>地點</th>
            </tr>
        </thead>
        <tbody>
            <!-- 這裡的行由 JavaScript 動態生成 -->
        </tbody>
    </table>
    <script>
        const sheetId = '1nT4r-mfhzpBqJSpWnw3rijNT4I58oAvT10oJ3P5s3bo';  // 試算表 ID
        const apiKey = 'AIzaSyDvk2OG1xiHZksYnQmMUAuTBvyGTZhQJ04';  // 你的 API 金鑰

        // 讀取試算表數據
        function fetchSheetData() {
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/Sheet1!A2:D?key=${apiKey}`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    const rows = data.values || [];
                    const tableBody = document.getElementById("editableTable").querySelector("tbody");

                    tableBody.innerHTML = ""; // 清空現有表格內容

                    // 根據取得的資料行數動態生成行
                    rows.forEach(row => {
                        const newRow = document.createElement("tr");
                        for (let i = 0; i < 4; i++) { // 假設有 4 列
                            const newCell = document.createElement("td");
                            newCell.innerText = row[i] || ""; // 若無數據則填空
                            newRow.appendChild(newCell);
                        }
                        tableBody.appendChild(newRow);
                    });

                    // 若資料不夠 6 行，可以額外補空行
                    const missingRows = 6 - rows.length;
                    for (let i = 0; i < missingRows; i++) {
                        const newRow = document.createElement("tr");
                        for (let j = 0; j < 4; j++) {
                            const newCell = document.createElement("td");
                            newCell.innerText = ""; // 空白單元格
                            newRow.appendChild(newCell);
                        }
                        tableBody.appendChild(newRow);
                    }
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        window.onload = function() {
            fetchSheetData(); // 頁面載入時立即載入數據
            setInterval(fetchSheetData, 30000); // 每 30秒自動刷新數據
        };
    </script>
</body>
</html>
